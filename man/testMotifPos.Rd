% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/testMotifPos.R
\name{testMotifPos}
\alias{testMotifPos}
\title{Test for a Uniform Distribution across a set of best matches}
\usage{
testMotifPos(
  pwm,
  stringset,
  matches,
  binwidth = 10,
  abs = FALSE,
  rc = TRUE,
  min_score = "80\%",
  break_ties = "all",
  alt = c("greater", "less", "two.sided"),
  mc.cores = 1,
  ...
)
}
\arguments{
\item{pwm}{A Position Weight Matrix, or list of PWMs. Not required if `matches`
is supplied.}

\item{stringset}{An XStringSet. Not required if `matches` is supplied}

\item{matches}{An optional set of 'best matches' as returned by
\link{getPwmMatches} setting `best_only = TRUE`. Alternatively, a list of
returned 'best matches' can be used. Any individual sequence with multiple
'best matches' will have each match weighted. If provided, will override
anything passed via `pwm` or `stringset.`}

\item{binwidth}{Width of bins across the range to group data into}

\item{abs}{Use absolute positions around zero to find symmetrical enrichment}

\item{rc}{logical(1) Also find matches using the reverse complement of pwm}

\item{min_score}{The minimum score to return a match}

\item{break_ties}{Choose how to resolve matches with tied scores}

\item{alt}{Alternative hypothesis for the binomial test}

\item{mc.cores}{Passed to \link[parallel]{mclapply}}

\item{...}{Passed to \link[Biostrings]{matchPWM}}
}
\value{
A data.frame with columns `start`, `end`, `centre`, `width`, `total_matches`,
`matches_in_region`, `expected`, `enrichment`, `prop_total`, `p`
and `consensus_motif`
The total matches represent the total number of matches within the set of
sequences, whilst the number observed in the final region are also given,
along with the proportion of the total this represents.
Enrichment is simply the ratio of observed to expected based on the
expectation of the null hypothesis

The consensus motif across all matches is returned as a Position Frequency
Matrix (PFM) using \link[Biostrings]{consensusMatrix}.
}
\description{
Test for a Uniform Distribution across a set of best matches
}
\details{
This function tests for an even positional spread of motif matches across a
set of sequences, using the assumption (i.e. H~0~) that if there is no
positional bias, matches will be evenly distributed across all positions
within a set of sequences.
Conversely, if there is positional bias, typically but not necessarily near
the centre of a range, this function intends to detect this signal, as a
rejection of the null hypothesis.

Input can be provided as the output from \link{getPwmMatches} setting
`best_only = TRUE` if these matches have already been identified.
If choosing to provide this object to the argument `matches`, nothing is required
for the arguments `pwm`, `stringset`, `rc`, `min_score` or `break_ties`
Otherwise, a Position Weight Matrix (PWM) and an `XStringSet` are required,
along with the relevant arguments, with best matches identified within the
function.

The set of best matches are then grouped into bins along the range, with the
central bin containing zero, and tallied.
Setting `abs` to `TRUE` will set all positions from the centre as
*absolute values*, returning counts purely as bins with distances from zero,
marking this as an inclusive lower bound.
Motif alignments are assigned into bins based on the central position of the
match, as provided in the column `from_centre` when calling
\link{getPwmMatches}.

The \link[stats]{binom.test} is performed on each bin using the alternative
hypothesis, with the returned p-values across all bins combined using the
Harmonic Mean p-value (HMP) (See \link[harmonicmeanp]{p.hmp}).
All bins with raw p-values below the HMP are identified and the returned
values for start, end, centre, width, matches in region, expected and
enrichment are across this set of bins.
The expectation is that where a positional bias is evident, this will be a
narrow range containing a non-trivial proportion of the total matches.
}
\examples{
## Load the example PWM
data("ex_pwm")
esr1 <- ex_pwm$ESR1

## Load the example Peaks
data("ar_er_peaks")
library(BSgenome.Hsapiens.UCSC.hg19)
genome <- BSgenome.Hsapiens.UCSC.hg19
seq <- getSeq(genome, ar_er_peaks)

## Get the best match and use this data
matches <- getPwmMatches(esr1, seq, best_only = TRUE)
## Test for enrichment in any position
testMotifPos(matches = matches)

## Provide a list of PWMs, testing for distance from zero
testMotifPos(ex_pwm, seq, abs = TRUE, binwidth = 10)


}
